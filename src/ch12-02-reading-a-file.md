## قراءة ملف

الآن سنضيف وظيفة لقراءة الملف المحدد في معامل `file_path`. أولاً، نحتاج إلى ملف
عينة لاختباره: سنستخدم ملفًا يحتوي على كمية صغيرة من النص على عدة أسطر مع بعض
الكلمات المكررة. تحتوي القائمة 12-3 على قصيدة لإيميلي ديكنسون ستعمل بشكل جيد!
أنشئ ملفًا يُسمى _poem.txt_ في المستوى الجذري لمشروعك، وأدخل القصيدة "I'm
Nobody! Who are you?"

<Listing number="12-3" file-name="poem.txt" caption="قصيدة لإيميلي ديكنسون تُشكل حالة اختبار جيدة.">

```text
{{#include ../listings/ch12-an-io-project/listing-12-03/poem.txt}}
```

</Listing>

مع وجود النص في مكانه، عدّل _src/main.rs_ وأضف كودًا لقراءة الملف، كما هو موضح
في القائمة 12-4.

<Listing number="12-4" file-name="src/main.rs" caption="قراءة محتويات الملف المحدد بواسطة المعامل الثاني">

```rust,should_panic,noplayground
{{#rustdoc_include ../listings/ch12-an-io-project/listing-12-04/src/main.rs:here}}
```

</Listing>

أولاً، نُدخل جزءًا ذا صلة من المكتبة القياسية باستخدام عبارة `use`: نحتاج إلى
`std::fs` للتعامل مع الملفات.

في `main`، تأخذ العبارة الجديدة `fs::read_to_string` معامل `file_path`، وتفتح
ذلك الملف، وتُرجع قيمة من نوع `std::io::Result<String>` تحتوي على محتويات
الملف.

بعد ذلك، نضيف مرة أخرى عبارة `println!` مؤقتة تطبع قيمة `contents` بعد قراءة
الملف حتى نتمكن من التحقق من أن البرنامج يعمل حتى الآن.

لنقم بتشغيل هذا الكود بأي نص كمعامل سطر الأوامر الأول (لأننا لم ننفذ جزء البحث
بعد) والملف _poem.txt_ كمعامل ثانٍ:

```console
{{#rustdoc_include ../listings/ch12-an-io-project/listing-12-04/output.txt}}
```

رائع! قرأ الكود ثم طبع محتويات الملف. لكن الكود به بعض العيوب. في الوقت الحالي،
تمتلك دالة `main` مسؤوليات متعددة: بشكل عام، تكون الدوال أكثر وضوحًا وأسهل في
الصيانة إذا كانت كل دالة مسؤولة عن فكرة واحدة فقط. المشكلة الأخرى هي أننا لا
نتعامل مع الأخطاء بشكل جيد كما يمكننا. لا يزال البرنامج صغيرًا، لذا هذه العيوب
ليست مشكلة كبيرة، لكن مع نمو البرنامج، سيكون من الأصعب إصلاحها بشكل نظيف. من
الممارسات الجيدة البدء في إعادة الهيكلة (refactoring) مبكرًا عند تطوير برنامج
لأنه من الأسهل بكثير إعادة هيكلة كميات أصغر من الكود. سنفعل ذلك بعد ذلك.
