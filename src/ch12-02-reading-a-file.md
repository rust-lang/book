## خواندن یک فایل

اکنون قابلیت خواندن فایل مشخص‌شده در آرگومان `file_path` را اضافه می‌کنیم. ابتدا به یک فایل نمونه برای تست نیاز داریم: از یک فایل با مقدار کمی متن در چندین خط که برخی کلمات در آن تکرار شده‌اند استفاده می‌کنیم. لیست ۱۲-۳ شامل شعری از امیلی دیکینسون است که به خوبی برای این منظور مناسب است! یک فایل به نام _poem.txt_ در سطح اصلی پروژه خود ایجاد کنید و شعر "I’m Nobody! Who are you?" را وارد کنید.

<Listing number="12-3" file-name="poem.txt" caption="شعری از امیلی دیکینسون که مورد تست مناسبی است.">

```text
{{#include ../listings/ch12-an-io-project/listing-12-03/poem.txt}}
```

</Listing>

با متن در جای خود، فایل _src/main.rs_ را ویرایش کرده و کدی برای خواندن فایل اضافه کنید، همانطور که در لیست ۱۲-۴ نشان داده شده است.

<Listing number="12-4" file-name="src/main.rs" caption="خواندن محتوای فایل مشخص‌شده توسط آرگومان دوم">

```rust,should_panic,noplayground
{{#rustdoc_include ../listings/ch12-an-io-project/listing-12-04/src/main.rs:here}}
```

</Listing>

ابتدا بخشی مرتبط از کتابخانه استاندارد را با یک دستور `use` وارد می‌کنیم: برای مدیریت فایل‌ها به `std::fs` نیاز داریم.

در تابع `main`، دستور جدید `fs::read_to_string` مقدار `file_path` را می‌گیرد، آن فایل را باز می‌کند و مقداری از نوع `std::io::Result<String>` را که شامل محتوای فایل است، بازمی‌گرداند.

پس از آن، دوباره یک دستور موقت `println!` اضافه می‌کنیم که مقدار `contents` را پس از خواندن فایل چاپ می‌کند تا مطمئن شویم برنامه تا اینجا کار می‌کند.

بیایید این کد را با هر رشته‌ای به عنوان اولین آرگومان خط فرمان (چون هنوز بخش جستجو را پیاده‌سازی نکرده‌ایم) و فایل _poem.txt_ به عنوان آرگومان دوم اجرا کنیم:

```console
{{#rustdoc_include ../listings/ch12-an-io-project/listing-12-04/output.txt}}
```

عالی است! کد محتوای فایل را خواند و سپس چاپ کرد. اما کد چند نقص دارد. در حال حاضر، تابع `main` چندین مسئولیت دارد: به طور کلی، توابع واضح‌تر و آسان‌تر برای نگهداری هستند اگر هر تابع فقط مسئول یک ایده باشد. مشکل دیگر این است که ما خطاها را به خوبی مدیریت نمی‌کنیم. برنامه هنوز کوچک است، بنابراین این مشکلات مشکل بزرگی نیستند، اما با رشد برنامه، رفع آن‌ها به صورت تمیز سخت‌تر خواهد شد. بهتر است که زودتر در فرایند توسعه برنامه شروع به بازسازی کنیم، زیرا بازسازی کدهای کمتر بسیار آسان‌تر است. در مرحله بعد این کار را انجام خواهیم داد.
