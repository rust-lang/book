<!-- Old headings. Do not remove or links may break. -->

<a id="comparing-performance-loops-vs-iterators"></a>

## الأداء في الحلقات مقابل المُكرِّرات

لتحديد ما إذا كان يجب استخدام الحلقات أو المُكرِّرات، تحتاج إلى معرفة أي تنفيذ أسرع: نسخة دالة `search` مع حلقة `for` صريحة أو النسخة مع المُكرِّرات.

قمنا بتشغيل معيار قياس عن طريق تحميل المحتويات الكاملة لـ _مغامرات شيرلوك هولمز_ بقلم السير آرثر كونان دويل في `String` والبحث عن كلمة _the_ في المحتويات. فيما يلي نتائج المعيار على نسخة `search` باستخدام حلقة `for` والنسخة باستخدام المُكرِّرات:

```text
test bench_search_for  ... bench:  19,620,300 ns/iter (+/- 915,700)
test bench_search_iter ... bench:  19,234,900 ns/iter (+/- 657,200)
```

التنفيذان لديهما أداء مماثل! لن نشرح كود المعيار هنا لأن النقطة ليست إثبات أن النسختين متكافئتان ولكن للحصول على إحساس عام بكيفية مقارنة هذين التنفيذين من حيث الأداء.

للحصول على معيار أكثر شمولاً، يجب عليك التحقق باستخدام نصوص مختلفة بأحجام مختلفة كـ `contents`، وكلمات مختلفة وكلمات بأطوال مختلفة كـ `query`، وجميع أنواع الاختلافات الأخرى. النقطة هي هذه: المُكرِّرات، على الرغم من كونها تجريدًا عالي المستوى، يتم ترجمتها إلى نفس الكود تقريبًا كما لو كنت قد كتبت الكود منخفض المستوى بنفسك. المُكرِّرات هي أحد _التجريدات ذات التكلفة الصفرية_ (zero-cost abstractions) في Rust، ونعني بذلك أن استخدام التجريد لا يفرض أي تكلفة إضافية في وقت التشغيل. هذا مشابه لكيفية تعريف بيارن ستروستروب، المصمم والمنفذ الأصلي لـ C++، للتكلفة الصفرية في عرضه التقديمي الرئيسي لـ ETAPS 2012 "أسس C++":

> بشكل عام، تتبع تطبيقات C++ مبدأ التكلفة الصفرية: ما لا تستخدمه، لا تدفع ثمنه. وأكثر من ذلك: ما تستخدمه، لا يمكنك كتابته يدويًا بشكل أفضل.

في كثير من الحالات، يترجم كود Rust الذي يستخدم المُكرِّرات إلى نفس الترجمة الذي كنت ستكتبه يدويًا. تنطبق التحسينات مثل فك الحلقة (loop unrolling) والقضاء على فحوصات الحدود على الوصول إلى المصفوفة وتجعل الكود الناتج فعالاً للغاية. الآن بعد أن عرفت هذا، يمكنك استخدام المُكرِّرات والإغلاقات دون خوف! إنها تجعل الكود يبدو وكأنه في مستوى أعلى لكنها لا تفرض عقوبة أداء في وقت التشغيل للقيام بذلك.

## الملخص

الإغلاقات والمُكرِّرات هي ميزات Rust مستوحاة من أفكار لغات البرمجة الوظيفية. تساهم في قدرة Rust على التعبير بوضوح عن الأفكار عالية المستوى بأداء منخفض المستوى. تنفيذات الإغلاقات والمُكرِّرات بحيث لا يتأثر أداء وقت التشغيل. هذا جزء من هدف Rust للسعي لتوفير تجريدات ذات تكلفة صفرية.

الآن بعد أن قمنا بتحسين التعبيرية لمشروع الإدخال/الإخراج الخاص بنا، دعنا ننظر إلى بعض الميزات الإضافية لـ `cargo` التي ستساعدنا في مشاركة المشروع مع العالم.
