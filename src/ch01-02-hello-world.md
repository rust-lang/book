## Hello, World!

เมื่อคุณติดตั้ง Rust แล้ว ก็ถึงเวลาเขียนโปรแกรม Rust แรกของคุณ เป็นธรรมเนียมปฏิบัติในการเรียนรู้ภาษาใหม่ที่จะเขียนโปรแกรมเล็กๆ ที่พิมพ์ข้อความ `Hello, world!` ออกทางหน้าจอ ดังนั้นเราจะทำเช่นเดียวกันที่นี่!

> หมายเหตุ: หนังสือเล่มนี้ตั้งสมมติฐานว่าคุณคุ้นเคยกับการใช้บรรทัดคำสั่งเบื้องต้น Rust ไม่ได้มีข้อกำหนดเฉพาะเกี่ยวกับโปรแกรมแก้ไขหรือเครื่องมือที่คุณใช้ หรือตำแหน่งที่โค้ดของคุณอยู่ ดังนั้นหากคุณต้องการใช้ Integrated Development Environment (IDE) แทนบรรทัดคำสั่ง ก็สามารถใช้ IDE ที่คุณชื่นชอบได้เลย ปัจจุบัน IDE หลายตัวรองรับ Rust ในระดับหนึ่ง โปรดตรวจสอบเอกสารประกอบของ IDE สำหรับรายละเอียด ทีม Rust ได้มุ่งเน้นไปที่การเปิดใช้งานการสนับสนุน IDE ที่ยอดเยี่ยมผ่าน `rust-analyzer` ดู [ภาคผนวก D][devtools]<!-- ignore --> สำหรับรายละเอียดเพิ่มเติม

### การสร้างไดเรกทอรีโปรเจกต์

คุณจะเริ่มต้นด้วยการสร้างไดเรกทอรีเพื่อเก็บโค้ด Rust ของคุณ Rust ไม่สนใจว่าโค้ดของคุณจะอยู่ที่ไหน แต่สำหรับแบบฝึกหัดและโปรเจกต์ในหนังสือเล่มนี้ เราขอแนะนำให้สร้างไดเรกทอรีชื่อ _projects_ ในโฮมไดเรกทอรีของคุณและเก็บโปรเจกต์ทั้งหมดของคุณไว้ที่นั่น

เปิดเทอร์มินัลและป้อนคำสั่งต่อไปนี้เพื่อสร้างไดเรกทอรี _projects_ และไดเรกทอรีสำหรับโปรเจกต์ “Hello, world!” ภายในไดเรกทอรี _projects_

สำหรับ Linux, macOS และ PowerShell บน Windows ให้ป้อนคำสั่งนี้:

```console
$ mkdir ~/projects
$ cd ~/projects
$ mkdir hello_world
$ cd hello_world
```

สำหรับ Windows CMD ให้ป้อนคำสั่งนี้:

```cmd
> mkdir "%USERPROFILE%\projects"
> cd /d "%USERPROFILE%\projects"
> mkdir hello_world
> cd hello_world
```

### การเขียนและรันโปรแกรม Rust

ถัดไป สร้างไฟล์ซอร์สโค้ดใหม่และตั้งชื่อว่า _main.rs_ ไฟล์ Rust จะลงท้ายด้วยนามสกุล _.rs_ เสมอ หากคุณใช้มากกว่าหนึ่งคำในชื่อไฟล์ของคุณ ตามธรรมเนียมปฏิบัติจะใช้อันเดอร์สกอร์เพื่อคั่นคำเหล่านั้น ตัวอย่างเช่น ใช้ _hello_world.rs_ แทน _helloworld.rs_

ตอนนี้เปิดไฟล์ _main.rs_ ที่คุณเพิ่งสร้างขึ้นและป้อนโค้ดใน Listing 1-1

<Listing number="1-1" file-name="main.rs" caption="โปรแกรมที่พิมพ์ `Hello, world!`">

```rust
fn main() {
    println!("Hello, world!");
}
```

</Listing>

บันทึกไฟล์และกลับไปที่หน้าต่างเทอร์มินัลของคุณในไดเรกทอรี _~/projects/hello_world_ บน Linux หรือ macOS ให้ป้อนคำสั่งต่อไปนี้เพื่อคอมไพล์และรันไฟล์:

```console
$ rustc main.rs
$ ./main
Hello, world!
```

บน Windows ให้ป้อนคำสั่ง `.\main` แทน `./main`:

```powershell
> rustc main.rs
> .\main
Hello, world!
```

ไม่ว่าระบบปฏิบัติการของคุณจะเป็นอะไร สตริง `Hello, world!` ควรจะพิมพ์ออกทางเทอร์มินัล หากคุณไม่เห็นผลลัพธ์นี้ โปรดย้อนกลับไปดูส่วน [“การแก้ไขปัญหา”][troubleshooting]<!-- ignore --> ของส่วนการติดตั้งสำหรับวิธีขอความช่วยเหลือ

หาก `Hello, world!` พิมพ์ออกมาแล้ว ขอแสดงความยินดีด้วย! คุณได้เขียนโปรแกรม Rust อย่างเป็นทางการแล้ว นั่นทำให้คุณเป็นโปรแกรมเมอร์ Rust—ยินดีต้อนรับ!

### โครงสร้างของโปรแกรม Rust

เรามาทบทวนโปรแกรม “Hello, world!” นี้โดยละเอียดกัน นี่คือส่วนแรกของจิ๊กซอว์:

```rust
fn main() {

}
```

บรรทัดเหล่านี้กำหนดฟังก์ชันชื่อ `main` ฟังก์ชัน `main` เป็นฟังก์ชันพิเศษ: มันเป็นโค้ดแรกที่ทำงานเสมอในทุกโปรแกรม Rust ที่เป็นไฟล์ εκτελέσιμο (executable) ในที่นี้ บรรทัดแรกประกาศฟังก์ชันชื่อ `main` ที่ไม่มีพารามิเตอร์และไม่คืนค่าอะไรเลย หากมีพารามิเตอร์ พารามิเตอร์เหล่านั้นจะอยู่ภายในวงเล็บ `()`

เนื้อหาของฟังก์ชัน (function body) จะถูกห่อหุ้มด้วย `{}` Rust กำหนดให้ใช้วงเล็บปีกการอบเนื้อหาของฟังก์ชันทั้งหมด เป็นสไตล์ที่ดีที่จะวางวงเล็บปีกกาเปิดบนบรรทัดเดียวกับส่วนประกาศฟังก์ชัน โดยเว้นวรรคหนึ่งช่องระหว่างกัน

> หมายเหตุ: หากคุณต้องการยึดตามสไตล์มาตรฐานในโปรเจกต์ Rust ต่างๆ คุณสามารถใช้เครื่องมือจัดรูปแบบอัตโนมัติที่เรียกว่า `rustfmt` เพื่อจัดรูปแบบโค้ดของคุณในสไตล์เฉพาะ (เพิ่มเติมเกี่ยวกับ `rustfmt` ใน [ภาคผนวก D][devtools]<!-- ignore -->) ทีม Rust ได้รวมเครื่องมือนี้เข้ากับการแจกจ่าย Rust มาตรฐาน เช่นเดียวกับ `rustc` ดังนั้นมันควรจะติดตั้งอยู่ในคอมพิวเตอร์ของคุณแล้ว!

เนื้อหาของฟังก์ชัน `main` ประกอบด้วยโค้ดต่อไปนี้:

```rust
println!("Hello, world!");
```

บรรทัดนี้ทำงานทั้งหมดในโปรแกรมเล็กๆ นี้: มันพิมพ์ข้อความออกทางหน้าจอ มีรายละเอียดที่สำคัญสามประการที่ควรสังเกตที่นี่

ประการแรก `println!` เรียกใช้มาโครของ Rust หากมันเรียกใช้ฟังก์ชันแทน มันจะถูกป้อนเป็น `println` (โดยไม่มี `!`) มาโครของ Rust เป็นวิธีการเขียนโค้ดที่สร้างโค้ดเพื่อขยาย синтаксис ของ Rust และเราจะพูดถึงมันในรายละเอียดเพิ่มเติมใน [บทที่ 20][ch20-macros]<!-- ignore --> สำหรับตอนนี้ คุณเพียงแค่ต้องรู้ว่าการใช้ `!` หมายความว่าคุณกำลังเรียกใช้มาโครแทนฟังก์ชันปกติ และมาโครไม่จำเป็นต้องปฏิบัติตามกฎเดียวกันกับฟังก์ชันเสมอไป

ประการที่สอง คุณจะเห็นสตริง `"Hello, world!"` เราส่งสตริงนี้เป็นอาร์กิวเมนต์ไปยัง `println!` และสตริงนั้นจะถูกพิมพ์ออกทางหน้าจอ

ประการที่สาม เราจบด้วยเครื่องหมายอัฒภาค (`;`) ซึ่งบ่งชี้ว่านิพจน์นี้สิ้นสุดแล้วและนิพจน์ถัดไปพร้อมที่จะเริ่ม บรรทัดโค้ด Rust ส่วนใหญ่จะลงท้ายด้วยเครื่องหมายอัฒภาค

### การคอมไพล์และการรันเป็นขั้นตอนที่แยกจากกัน

คุณเพิ่งรันโปรแกรมที่สร้างขึ้นใหม่ ดังนั้นเรามาตรวจสอบแต่ละขั้นตอนในกระบวนการกัน

ก่อนที่จะรันโปรแกรม Rust คุณต้องคอมไพล์มันโดยใช้คอมไพเลอร์ Rust โดยป้อนคำสั่ง `rustc` และส่งชื่อไฟล์ซอร์สโค้ดของคุณไปให้มัน ดังนี้:

```console
$ rustc main.rs
```

หากคุณมีพื้นฐาน C หรือ C++ คุณจะสังเกตเห็นว่าสิ่งนี้คล้ายกับ `gcc` หรือ `clang` หลังจากคอมไพล์สำเร็จ Rust จะส่งออกไฟล์ εκτελέσιμο (binary executable)

บน Linux, macOS และ PowerShell บน Windows คุณสามารถดูไฟล์ εκτελέσιμο (executable) ได้โดยป้อนคำสั่ง `ls` ในเชลล์ของคุณ:

```console
$ ls
main  main.rs
```

บน Linux และ macOS คุณจะเห็นสองไฟล์ ด้วย PowerShell บน Windows คุณจะเห็นสามไฟล์เดียวกันกับที่คุณจะเห็นเมื่อใช้ CMD ด้วย CMD บน Windows คุณจะต้องป้อนคำสั่งต่อไปนี้:

```cmd
> dir /B %= a tùy chọn /B có nghĩa là chỉ hiển thị tên tệp =%
main.exe
main.pdb
main.rs
```

สิ่งนี้แสดงไฟล์ซอร์สโค้ดที่มีนามสกุล _.rs_, ไฟล์ εκτελέσιμο (executable) (_main.exe_ บน Windows แต่เป็น _main_ บนแพลตฟอร์มอื่นๆ ทั้งหมด) และเมื่อใช้ Windows จะมีไฟล์ที่มีข้อมูลการดีบักพร้อมนามสกุล _.pdb_ จากที่นี่ คุณรันไฟล์ _main_ หรือ _main.exe_ ดังนี้:

```console
$ ./main # หรือ .\main บน Windows
```

หากไฟล์ _main.rs_ ของคุณคือโปรแกรม “Hello, world!” บรรทัดนี้จะพิมพ์ `Hello, world!` ออกทางเทอร์มินัลของคุณ

หากคุณคุ้นเคยกับภาษาไดนามิกมากกว่า เช่น Ruby, Python หรือ JavaScript คุณอาจไม่คุ้นเคยกับการคอมไพล์และรันโปรแกรมเป็นขั้นตอนที่แยกจากกัน Rust เป็นภาษาที่ _คอมไพล์ล่วงหน้า_ (ahead-of-time compiled) หมายความว่าคุณสามารถคอมไพล์โปรแกรมและให้ไฟล์ εκτελέσιμο (executable) แก่ผู้อื่น และพวกเขาสามารถรันมันได้แม้ว่าจะไม่ได้ติดตั้ง Rust ก็ตาม หากคุณให้ไฟล์ _.rb_, _.py_ หรือ _.js_ แก่ใครบางคน พวกเขาจำเป็นต้องติดตั้ง υλοποίηση (implementation) ของ Ruby, Python หรือ JavaScript (ตามลำดับ) แต่ในภาษาเหล่านั้น คุณต้องการเพียงคำสั่งเดียวในการคอมไพล์และรันโปรแกรมของคุณ ทุกอย่างเป็นการแลกเปลี่ยนในการออกแบบภาษา

การคอมไพล์ด้วย `rustc` เพียงอย่างเดียวนั้นเพียงพอสำหรับโปรแกรมง่ายๆ แต่เมื่อโปรเจกต์ของคุณเติบโตขึ้น คุณจะต้องการจัดการตัวเลือกทั้งหมดและทำให้ง่ายต่อการแบ่งปันโค้ดของคุณ ถัดไป เราจะแนะนำให้คุณรู้จักกับเครื่องมือ Cargo ซึ่งจะช่วยให้คุณเขียนโปรแกรม Rust ในโลกแห่งความเป็นจริงได้

[troubleshooting]: ch01-01-installation.html#troubleshooting
[devtools]: appendix-04-useful-development-tools.html
[ch20-macros]: ch20-05-macros.html
